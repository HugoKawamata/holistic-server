export const romajiHiraganaMap = {
  a: "„ÅÇ",
  i: "„ÅÑ",
  u: "„ÅÜ",
  e: "„Åà",
  o: "„Åä",
  ka: "„Åã",
  ki: "„Åç",
  ku: "„Åè",
  ke: "„Åë",
  ko: "„Åì",
  ga: "„Åå",
  gi: "„Åé",
  gu: "„Åê",
  ge: "„Åí",
  go: "„Åî",
  sa: "„Åï",
  shi: "„Åó",
  su: "„Åô",
  se: "„Åõ",
  so: "„Åù",
  za: "„Åñ",
  ji: "„Åò",
  zu: "„Åö",
  ze: "„Åú",
  zo: "„Åû",
  ta: "„Åü",
  chi: "„Å°",
  tsu: "„Å§",
  te: "„Å¶",
  to: "„Å®",
  da: "„Å†",
  dji: "„Å¢",
  dzu: "„Å•",
  de: "„Åß",
  do: "„Å©",
  na: "„Å™",
  ni: "„Å´",
  nu: "„Å¨",
  ne: "„Å≠",
  no: "„ÅÆ",
  ha: "„ÅØ",
  hi: "„Å≤",
  fu: "„Åµ",
  he: "„Å∏",
  ho: "„Åª",
  ba: "„Å∞",
  bi: "„Å≥",
  bu: "„Å∂",
  be: "„Åπ",
  bo: "„Åº",
  pa: "„Å±",
  pi: "„Å¥",
  pu: "„Å∑",
  pe: "„Å∫",
  po: "„ÅΩ",
  ma: "„Åæ",
  mi: "„Åø",
  mu: "„ÇÄ",
  me: "„ÇÅ",
  mo: "„ÇÇ",
  ya: "„ÇÑ",
  yu: "„ÇÜ",
  yo: "„Çà",
  ra: "„Çâ",
  ri: "„Çä",
  ru: "„Çã",
  re: "„Çå",
  ro: "„Çç",
  wa: "„Çè",
  wo: "„Çí",
  n: "„Çì",
  kya: "„Åç„ÇÉ",
  kyu: "„Åç„ÇÖ",
  kyo: "„Åç„Çá",
  gya: "„Åé„ÇÉ",
  gyu: "„Åé„ÇÖ",
  gyo: "„Åé„Çá",
  sha: "„Åó„ÇÉ",
  shu: "„Åó„ÇÖ",
  sho: "„Åó„Çá",
  ja: "„Åò„ÇÉ",
  ju: "„Åò„ÇÖ",
  jo: "„Åò„Çá",
  cha: "„Å°„ÇÉ",
  chu: "„Å°„ÇÖ",
  cho: "„Å°„Çá",
  nya: "„Å´„ÇÉ",
  nyu: "„Å´„ÇÖ",
  nyo: "„Å´„Çá",
  hya: "„Å≤„ÇÉ",
  hyu: "„Å≤„ÇÖ",
  hyo: "„Å≤„Çá",
  bya: "„Å≥„ÇÉ",
  byu: "„Å≥„ÇÖ",
  byo: "„Å≥„Çá",
  pya: "„Å¥„ÇÉ",
  pyu: "„Å¥„ÇÖ",
  pyo: "„Å¥„Çá",
  mya: "„Åø„ÇÉ",
  myu: "„Åø„ÇÖ",
  myo: "„Åø„Çá",
  rya: "„Çä„ÇÉ",
  ryu: "„Çä„ÇÖ",
  ryo: "„Çä„Çá",
};

export const hiraganaRomajiMap = {
  „ÅÇ: "a",
  „ÅÑ: "i",
  „ÅÜ: "u",
  „Åà: "e",
  „Åä: "o",
  „Åã: "ka",
  „Åç: "ki",
  „Åè: "ku",
  „Åë: "ke",
  „Åì: "ko",
  „Åå: "ga",
  „Åé: "gi",
  „Åê: "gu",
  „Åí: "ge",
  „Åî: "go",
  „Åï: "sa",
  „Åó: "shi",
  „Åô: "su",
  „Åõ: "se",
  „Åù: "so",
  „Åñ: "za",
  „Åò: "ji",
  „Åö: "zu",
  „Åú: "ze",
  „Åû: "zo",
  „Åü: "ta",
  „Å°: "chi",
  „Å§: "tsu",
  „Å¶: "te",
  „Å®: "to",
  „Å†: "da",
  „Å¢: "dji",
  „Å•: "dzu",
  „Åß: "de",
  „Å©: "do",
  „Å™: "na",
  „Å´: "ni",
  „Å¨: "nu",
  „Å≠: "ne",
  „ÅÆ: "no",
  „ÅØ: "ha",
  „Å≤: "hi",
  „Åµ: "fu",
  „Å∏: "he",
  „Åª: "ho",
  „Å∞: "ba",
  „Å≥: "bi",
  „Å∂: "bu",
  „Åπ: "be",
  „Åº: "bo",
  „Å±: "pa",
  „Å¥: "pi",
  „Å∑: "pu",
  „Å∫: "pe",
  „ÅΩ: "po",
  „Åæ: "ma",
  „Åø: "mi",
  „ÇÄ: "mu",
  „ÇÅ: "me",
  „ÇÇ: "mo",
  „ÇÑ: "ya",
  „ÇÜ: "yu",
  „Çà: "yo",
  „Çâ: "ra",
  „Çä: "ri",
  „Çã: "ru",
  „Çå: "re",
  „Çç: "ro",
  „Çè: "wa",
  „Çí: "wo",
  „Çì: "n",
  „Åç„ÇÉ: "kya",
  „Åç„ÇÖ: "kyu",
  „Åç„Çá: "kyo",
  „Åé„ÇÉ: "gya",
  „Åé„ÇÖ: "gyu",
  „Åé„Çá: "gyo",
  „Åó„ÇÉ: "sha",
  „Åó„ÇÖ: "shu",
  „Åó„Çá: "sho",
  „Åò„ÇÉ: "ja",
  „Åò„ÇÖ: "ju",
  „Åò„Çá: "jo",
  „Å°„ÇÉ: "cha",
  „Å°„ÇÖ: "chu",
  „Å°„Çá: "cho",
  „Å´„ÇÉ: "nya",
  „Å´„ÇÖ: "nyu",
  „Å´„Çá: "nyo",
  „Å≤„ÇÉ: "hya",
  „Å≤„ÇÖ: "hyu",
  „Å≤„Çá: "hyo",
  „Å≥„ÇÉ: "bya",
  „Å≥„ÇÖ: "byu",
  „Å≥„Çá: "byo",
  „Å¥„ÇÉ: "pya",
  „Å¥„ÇÖ: "pyu",
  „Å¥„Çá: "pyo",
  „Åø„ÇÉ: "mya",
  „Åø„ÇÖ: "myu",
  „Åø„Çá: "myo",
  „Çä„ÇÉ: "rya",
  „Çä„ÇÖ: "ryu",
  „Çä„Çá: "ryo",
};

const hiraganaToRomajiCSV = (hiragana) => {
  let splitQuestion = [];

  // We have to go backwards due to lya/lyu/lyo
  while (hiragana.length > 0) {
    let current = hiragana[hiragana.length - 1];
    hiragana = hiragana.slice(0, hiragana.length - 1);
    if (Object.keys(hiraganaRomajiMap).includes(current)) {
      splitQuestion = [current, ...splitQuestion];
    } else {
      current = `${hiragana[hiragana.length - 1]}${current}`;
      splitQuestion = [current, ...splitQuestion];
    }
  }
  return splitQuestion;
};

export const nextLessonResolver = (pg) => {
  return (user, args) => {
    // No args given, just generate the next lesson with the defaults
    if (Object.keys(args).length < 1) {
      if (user.kana_level != "COMPLETE") {
        return getKanaLesson(user.kana_level, pg);
      }

      return {
        content: "OTHER",
        preface: [],
        testables: [],
      };
    }
  };
};

const getKanaLesson = (kana_level, pg) => {
  switch (kana_level) {
    case null:
      return getHiraganaALesson(pg);
    case "HIRAGANA_A":
      return getHiraganaALesson(pg);
    default:
      throw new Error("Invalid kana level");
  }
};

const getHiraganaALesson = async (pg) => {
  const aWords = await pg("words").whereIn("id", [1, 2, 3, 4]);
  console.log("AWORDS", aWords);
  const testables = aWords.map((word) => ({
    objectId: word.id,
    objectType: "WORD",
    question: {
      type: "J_WORD",
      image: word.image,
      emoji: word.emoji,
      text: word.hiragana,
    },
    answer: {
      type: "ROMAJI",
      text: hiraganaToRomajiCSV(word.hiragana),
    },
    introduction: word.introduction,
  }));
  console.log("TESTABLES", testables);
  return {
    content: "HIRAGANA_A",
    testables,
  };
};

// return {
//   content: "HIRAGANA_A",
//   testables: [
//     {
//       objectId: 1,
//       objectType: "WORD",
//       question: {
//         type: "J_WORD",
//         image: null,
//         emoji: "üîµ",
//         text: "„ÅÇ„Åä",
//       },
//       answer: {
//         type: "ROMAJI",
//         text: "a,o",
//       },
//       notes: {
//         text:
//           'This word means "blue". The first letter is "a" and the second letter is "o". Make sure you listen to the pronunciation!',
//       },
//     },
//     {
//       objectId: 2,
//       objectType: "WORD",
//       question: {
//         type: "J_WORD",
//         image: null,
//         emoji: "üè†",
//         text: "„ÅÑ„Åà",
//       },
//       answer: {
//         type: "ROMAJI",
//         text: "i,e",
//       },
//       notes: {
//         text:
//           'This is "house". The first letter is "i" and the second letter is "e".',
//       },
//     },
//     {
//       objectId: 3,
//       objectType: "WORD",
//       question: {
//         type: "J_WORD",
//         image: null,
//         emoji: "üôÖ‚Äç‚ôÄÔ∏è",
//         text: "„ÅÑ„ÅÑ„Åà",
//       },
//       answer: {
//         type: "ROMAJI",
//         text: "i,i,e",
//       },
//       notes: {
//         text:
//           'This word means "no". It\'s very similar to "house" isn\'t it? The only difference is you say "ii" for longer.',
//       },
//     },
//     {
//       objectId: 4,
//       objectType: "WORD",
//       question: {
//         type: "J_WORD",
//         image: null,
//         emoji: "‚¨ÜÔ∏è",
//         text: "„ÅÜ„Åà",
//       },
//       answer: {
//         type: "ROMAJI",
//         text: "u,e",
//       },
//       notes: {
//         text:
//           'This word means "up". The first letter is "u". You should already know the second letter!',
//       },
//     },
//   ],
//   preface: [
//     {
//       text:
//         "Hiragana consists of 5 characters that represent vowel sounds (A, I, U, E, O) and 40 characters that represent a consonant-plus-a-vowel-sound (K, S, T, N, H, M, Y, …æ, and W), as well as a single lone consonant (N).",
//       image:
//         "https://res.cloudinary.com/holistic-japanese/image/upload/v1587262011/lessons/hiragana-a/preface-1.png",
//     },
//     {
//       text:
//         'Because the characters represent syllables, they are always pronounced the same. Unlike in English, where "same" is pronouned with a long A sound, the Japanese "„Åï„ÇÅ" ü¶à (sa„Éªme) is pronounced "sah-meh".',
//       image:
//         "https://res.cloudinary.com/holistic-japanese/image/upload/v1587262012/lessons/hiragana-a/preface-2.png",
//     },
//   ],
//   titleScreen: {
//     title: "Hiragana Lesson 1",
//     image:
//       "https://res.cloudinary.com/holistic-japanese/image/upload/v1587262008/lessons/hiragana-a/preface-3.png",
//   },
// };
